<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>GE Lotto</title>
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.8.1/font/bootstrap-icons.min.css" integrity="sha512-Oy+sz5W86PK0ZIkawrG0iv7XwWhYecM3exvUtMKNJMekGFJtVAhibhRPTpmyTj8+lJCkmWfnpxKgT2OopquBHA==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous" />
    <link rel="stylesheet" href="css/style.css" />
</head>
<body>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha384-VHvPCCyXqtD5DqJeNxl2dtTyhF78xXNXdkwX1CZeRusQfRKp+tA7hAShOK/B/fQ2" crossorigin="anonymous"></script>

    <div class="bg-cover">
        <div class="bg-color"></div>
    </div>
    <div class="content">
        <header class="main container text-center">
            <div class="row">
                <div class="col">
                    <a id="top"></a>
                    <img id="img-crest" src="./css/logo.png" alt="Crest" />
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <img id="img-logo" src="./css/swords-of-light.png" alt="Swords of Light" />
                    <h2>Guild Expedition Lotto</h2>
                </div>
            </div>
        </header>

        <form class="main container">
            <p>This will generate a list of winners according to the amount of donations available and the encounter filters below. Please review the data under More info. <b>Winner selection is unique.</b> Running the lottery again will select new winners.</p>
            <div class="row form-row align-items-center">
                <div class="col-md-5 col-auto mr-2">
                    <h4 id="fps-available">FP available: 0</h4>
                    <div class="input-group mb-3" data-toggle="tooltip" data-placement="bottom" title="Restrict the number of FP in the pool.">
                        <div class="input-group-prepend">
                            <div class="input-group-text">Max</div>
                        </div>
                        <input id="inputMaxFPs" type="text" class="form-control">
                    </div>
                </div>
                <div class="col-md-6 col">
                    <h4>Encounters</h4>
                    <div class="row form-row">
                        <div class="col">
                            <div class="input-group mb-3" data-toggle="tooltip" data-placement="bottom" title="Maximum number of encounters to be awarded.">
                                <div class="input-group-prepend">
                                    <div class="input-group-text">Max</div>
                                </div>
                                <input id="inputMaxEncounters" type="text" class="form-control" placeholder="64">
                            </div>
                        </div>
                        <div class="col">
                            <div class="input-group mb-3" data-toggle="tooltip" data-placement="bottom" title="Minimum number of encounters to participate.">
                                <div class="input-group-prepend">
                                    <div class="input-group-text">Min</div>
                                </div>
                                <input id="inputMinEncounters" type="text" class="form-control" placeholder="0">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>

        <nav class="main container sticky-top" role="navigation">
            <div class="row align-items-center">
                <div class="col-md col">
                    <div class="input-group">
                        <div class="input-group-append">
                            <button id="lottery-button" class="btn btn-dark" type="button" onclick="handleLotteryClick();" data-toggle="tooltip" data-placement="bottom" title="Participants and donors are shuffled to keep things fair">
                                Lottery!
                            </button>
                            <button id="info-button" class="btn btn-info" type="button" onclick="handleInfoClick();" data-toggle="tooltip" data-placement="bottom" data-html="true"title="[Players] {0}<br>[Donors] {1}<br>[Donations] {2} FP">
                                More Info
                            </button>
                            <button id="refresh-button" class="btn btn-dark" style="color:#FFFFFF" type="button" onclick="handleReloadData();" title="Reload from the sheet" data-toggle="tooltip" data-placement="bottom" data-html="true">
                                <i class="bi-arrow-clockwise"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="js-top" class="col-md col-auto text-right js-top">
                    <a href="#top" class="bi-arrow-up-circle" role="button"></a>
                </div>
            </div>
        </nav>

        <section id="tables-info" class="main container hidden mt-4">
            <h3 class="text-center">Players information</h3>
            <p>This is the list of participating players. However, only eligible players highlighted in green are entered into the contest. Adjust filters above as needed.</p>
            <hr class="text-center">

            <button class="btn btn-info" type="button" onclick="handleCreatePost();">Create Intro Post</button>
            <div id="intro-post" class="create-post hidden">
                <button type="button" class="js-clipboard btn btn-clipboard btn-primary btn-sm float-right" title="" onclick="copyTextArea('intro-area')">
                    <i class="bi-clipboard-plus-fill"></i>
                </button>
                <div class="form-group">
                    <textarea class="form-control" id="intro-area" rows="10"></textarea>
                </div>
            </div>

            <div class="row mt-2">
                <div class="col">
                    <table id="table-players" class="table table-sm table-striped table-light">
                        <thead class="thead-dark">
                            <tr>
                                <th scope="col">Players</th>
                                <th scope="col">Building</th>
                                <th scope="col">Encounters</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>

                <div class="col">
                    <div class="bd-clipboard">
                        <button type="button" class="js-clipboard btn btn-clipboard btn-primary btn-sm float-right" title="" data-original-title="Copy to clipboard" onclick="copyTable('table-donors')">
                            <i class="bi-clipboard-plus-fill"></i>
                        </button>
                    </div>
                    <table id="table-donors" class="table table-sm table-striped table-light">
                        <thead class="thead-dark">
                            <tr>
                                <th scope="col">Donors</th>
                                <th scope="col">Forge points</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>

                    <div class="bd-clipboard">
                        <button type="button" class="js-clipboard btn btn-clipboard btn-primary btn-sm float-right" title="" data-original-title="Copy to clipboard" onclick="copyTable('table-buildings')">
                            <i class="bi-clipboard-plus-fill"></i>
                        </button>
                    </div>
                    <table id="table-buildings" class="table table-sm table-striped table-light">
                        <thead class="thead-dark">
                            <tr>
                                <th scope="col">Players</th>
                                <th scope="col">Building</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="tables-lottery" class="main container hidden mt-4">
            <h3 class="text-center">Winners selection</h3>
            <hr class="text-center">

            <button class="btn btn-info" type="button" onclick="handleCreateWinnerPost();">Create Winner Post</button>
            <div id="winner-post" class="create-post">
                <div class="bd-clipboard">
                    <button type="button" class="js-clipboard btn btn-clipboard btn-primary btn-sm float-right" title="" data-original-title="Copy to clipboard" onclick="copyTextArea('winner-area')">
                        <i class="bi-clipboard-plus-fill"></i>
                    </button>
                </div>
                <div class="form-group">
                    <textarea class="form-control" id="winner-area" rows="10"></textarea>
                </div>
            </div>

            <div class="row mt-2">
                <div class="col-sm">
                    <div class="bd-clipboard">
                        <button type="button" class="js-clipboard btn btn-clipboard btn-primary btn-sm float-right" title="" data-original-title="Copy to clipboard" onclick="copyTable('table-winners')">
                            <i class="bi-clipboard-plus-fill"></i>
                        </button>
                    </div>
                    <table id="table-winners" class="table table-sm table-striped table-light">
                        <thead class="thead-dark">
                            <tr>
                                <th scope="col">Winners</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
                <div class="col-sm">
                    <div class="bd-clipboard">
                        <button type="button" class="js-clipboard btn btn-clipboard btn-primary btn-sm float-right" title="" data-original-title="Copy to clipboard" onClick="copyTable('table-winners-donors')">
                            <i class="bi-clipboard-plus-fill"></i>
                        </button>
                    </div> 
                    <table id="table-winners-donors" class="table table-sm table-striped table-light">
                        <thead class="thead-dark">
                            <tr>
                                <th scope="col">Donations</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
    </div>

    <script type="text/javascript" src="js/utils.js"></script>
    <script type="text/javascript" src="js/formatData.js"></script>
    <script type="text/javascript" src="index.js"></script>
</body>
</html>